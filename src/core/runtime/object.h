// ======================================================================================
// File         : object.h
// Author       : Wu Jie 
// Last Change  : 11/26/2010 | 16:35:55 PM | Friday,November
// Description  : 
// ======================================================================================

// #################################################################################
#ifndef OBJECT_H_1290760556
#define OBJECT_H_1290760556
// #################################################################################

// ######################### 
#ifdef __cplusplus
extern "C" { 
#endif
// ######################### 

///////////////////////////////////////////////////////////////////////////////
// struct
///////////////////////////////////////////////////////////////////////////////

typedef struct ex_object_t {
    ex_rtti_t* _rtti;
} ex_object_t;

extern strid_t __CLASSID_ex_object_t;

// EXAMPLE: a class inherit from ex_object_t { 
// typedef struct TestClass {
//     const struct ex_object_t _;
//     int8 _item1;
//     float _item2;
// } TestClass;
// } EXAMPLE end 

///////////////////////////////////////////////////////////////////////////////
// macros
///////////////////////////////////////////////////////////////////////////////

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

// TODO: #define EX_SUPER(_type,_obj)
#define EX_CLASSID(_name) __CLASSID_##_name

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

#define EX_DECL_CLASS_BEGIN(_name,_super) \
    typedef struct _name { \
        const struct _super _; \

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

#define EX_DECL_CLASS_END(_name) \
    } _name; \
    extern strid_t __CLASSID_##_name; \
    inline _name* _name##_alloc() { \
        _name* obj = ex_malloc(sizoef(_name)); \
        (ex_object_t*)obj->_rtti = ex_rtti_get(EX_CLASSID(_name)); \
        return obj; \
    }


// ######################### 
#ifdef __cplusplus
} // end extern C 
#endif
// ######################### 


// #################################################################################
#endif // END OBJECT_H_1290760556
// #################################################################################


