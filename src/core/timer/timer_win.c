// ======================================================================================
// File         : timer_win32.c
// Author       : Wu Jie 
// Last Change  : 01/05/2011 | 20:48:02 PM | Wednesday,January
// Description  : 
// ======================================================================================

///////////////////////////////////////////////////////////////////////////////
// includes
///////////////////////////////////////////////////////////////////////////////

#include "exsdk.h"

///////////////////////////////////////////////////////////////////////////////
// defines
///////////////////////////////////////////////////////////////////////////////

static LARGE_INTEGER __start_ticks;
static LARGE_INTEGER __freq;

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

int ex_sys_timer_init () {
    // init start ticks and cpu frequency
    QueryPerformanceFrequency(&__freq);
    QueryPerformanceCounter(&__start_ticks);

    return 0;
}

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

void ex_sys_timer_deinit () {
}

// ------------------------------------------------------------------ 
// Desc: return ms 
// ------------------------------------------------------------------ 

uint32 ex_timer_get_ticks () {
    LARGE_INTEGER now;
    QueryPerformanceCounter(&now);

    now.QuadPart -= __start_ticks.QuadPart;
    now.QuadPart *= 1000;
    now.QuadPart /= __freq.QuadPart;

    return (DWORD) now.QuadPart;
}
