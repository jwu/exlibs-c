// ======================================================================================
// File         : lua_behavior.h
// Author       : Wu Jie 
// Last Change  : 03/01/2011 | 15:33:24 PM | Tuesday,March
// Description  : 
// ======================================================================================

// #################################################################################
#ifndef LUA_BEHAVIOR_H_1298964806
#define LUA_BEHAVIOR_H_1298964806
// #################################################################################

// ######################### 
#ifdef __cplusplus
extern "C" { 
#endif
// ######################### 

///////////////////////////////////////////////////////////////////////////////
// includes
///////////////////////////////////////////////////////////////////////////////

#include "behavior.h"
    
///////////////////////////////////////////////////////////////////////////////
// defines
///////////////////////////////////////////////////////////////////////////////

// ------------------------------------------------------------------ 
/*! 
 @struct ex_lua_behavior_t
 @details
*/// ------------------------------------------------------------------ 

EX_DECL_CLASS_SUPER_BEGIN(ex_lua_behavior_t,ex_behavior_t)
    bool compile_failed;
    ex_hashmap_t *name_to_timer;
    ex_hashmap_t *name_to_co;
    ex_hashmap_t *state_to_params;
    ex_mutex_t *timer_mutex;
    ex_mutex_t *co_mutex;
EX_DECL_CLASS_SUPER_END(ex_lua_behavior_t,ex_behavior_t)

///////////////////////////////////////////////////////////////////////////////
// functions
///////////////////////////////////////////////////////////////////////////////

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

extern void ex_lua_behavior_invoke ( ex_ref_t *_self, 
                                     struct lua_State *_cur_state,
                                     float _secs_delay, 
                                     float _secs_repeat,
                                     const char *_name );

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

extern void ex_lua_behavior_cancle_invoke ( ex_ref_t *_self, const char *_name );

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

extern bool ex_lua_behavior_is_invoking ( ex_ref_t *_self, const char *_name );

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

extern int ex_lua_behavior_start_coroutine ( ex_ref_t *_self, 
                                             struct lua_State *_cur_state,
                                             const char *_name,
                                             int _nargs );

// ------------------------------------------------------------------ 
// Desc: 
// ------------------------------------------------------------------ 

extern int ex_lua_behavior_stop_coroutine ( ex_ref_t *_self, const char *_name );

// ######################### 
#ifdef __cplusplus
} // end extern C 
#endif
// ######################### 

// #################################################################################
#endif // END LUA_BEHAVIOR_H_1298964806
// #################################################################################
